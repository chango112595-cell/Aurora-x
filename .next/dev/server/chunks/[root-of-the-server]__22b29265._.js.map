{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 124, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/negry/Aurora-x/server/aurora-chat.ts"],"sourcesContent":["import { WebSocket, WebSocketServer } from 'ws';\r\n\r\n// Aurora's chat WebSocket server\r\nexport function setupAuroraChatWebSocket(server: any) {\r\n  const wss = new WebSocketServer({ \r\n    server,\r\n    path: '/aurora/chat'\r\n  });\r\n\r\n  wss.on('connection', (ws: WebSocket) => {\r\n    console.log('[Aurora] New chat connection established');\r\n    \r\n    // Welcome message\r\n    ws.send(JSON.stringify({\r\n      message: 'Aurora online. All 27 mastery tiers active. How may I assist?'\r\n    }));\r\n\r\n    ws.on('message', async (data: Buffer) => {\r\n      try {\r\n        const { message, sessionId } = JSON.parse(data.toString());\r\n        console.log('[Aurora] Received:', message);\r\n        \r\n        // Aurora processes the message using her omniscient knowledge\r\n        const response = await processWithAuroraIntelligence(message, sessionId || 'websocket');\r\n        \r\n        ws.send(JSON.stringify({\r\n          message: response\r\n        }));\r\n      } catch (error) {\r\n        console.error('[Aurora] Error:', error);\r\n        ws.send(JSON.stringify({\r\n          message: 'Error processing request'\r\n        }));\r\n      }\r\n    });\r\n\r\n    ws.on('close', () => {\r\n      console.log('[Aurora] Chat connection closed');\r\n    });\r\n  });\r\n\r\n  console.log('[Aurora] Chat WebSocket server ready on /aurora/chat');\r\n}\r\n\r\nasync function processWithAuroraIntelligence(userMessage: string, sessionId: string = 'default'): Promise<string> {\r\n  // Call Aurora's REAL Python intelligence - no templates\r\n  const { spawn } = await import('child_process');\r\n  const path = await import('path');\r\n  \r\n  return new Promise((resolve) => {\r\n    const script = `\r\nimport sys\r\nimport json\r\nsys.path.insert(0, '${process.cwd().replace(/\\\\/g, '/')}')\r\n\r\nfrom aurora_core import AuroraCoreIntelligence\r\n\r\naurora = AuroraCoreIntelligence()\r\n\r\n# Analyze with Aurora's REAL intelligence\r\nanalysis = aurora.analyze_natural_language('''${userMessage.replace(/'/g, \"\\\\'\")}''')\r\n\r\n# Generate Aurora's ACTUAL response (not templates) - PASS SESSION_ID\r\ncontext = aurora.get_conversation_context('${sessionId}')\r\nresponse = aurora.generate_aurora_response(analysis, context, '${sessionId}')\r\n\r\n# Output ONLY the response\r\nprint(json.dumps({'response': response}))\r\n`;\r\n\r\n    const python = spawn('python', ['-c', script]);\r\n    let output = '';\r\n    let errors = '';\r\n\r\n    python.stdout.on('data', (data) => output += data.toString());\r\n    python.stderr.on('data', (data) => errors += data.toString());\r\n\r\n    python.on('close', (code) => {\r\n      try {\r\n        // Find the JSON response line\r\n        const jsonLine = output.split('\\n').find(l => l.trim().startsWith('{\"response\"'));\r\n        \r\n        if (jsonLine) {\r\n          const parsed = JSON.parse(jsonLine.trim());\r\n          resolve(parsed.response);\r\n        } else {\r\n          // Check if we have valid output from Python\r\n          const cleanOutput = output\r\n            .split('\\n')\r\n            .filter(l => {\r\n              const trimmed = l.trim();\r\n              // Keep lines that look like real responses, exclude debug output\r\n              return trimmed && \r\n                     !trimmed.startsWith('[') && \r\n                     !trimmed.startsWith('Auto-') &&\r\n                     !trimmed.startsWith('Intelligent') &&\r\n                     !trimmed.includes('---') &&\r\n                     !trimmed.includes('sys.path') &&\r\n                     trimmed.length > 10;\r\n            })\r\n            .join('\\n')\r\n            .trim();\r\n          \r\n          if (cleanOutput) {\r\n            resolve(cleanOutput);\r\n          } else {\r\n            // Genuine fallback - Aurora should never get here\r\n            console.error('[Aurora] No valid output. Raw:', output);\r\n            resolve(`I received your message: \"${userMessage}\"\\n\\nLet me analyze this and provide a complete response. What specifically would you like me to help you with?`);\r\n          }\r\n        }\r\n      } catch (e) {\r\n        console.error('[Aurora] Parse error:', e, '\\nRaw output:', output);\r\n        resolve(`Hello! I'm Aurora. I understand you said: \"${userMessage}\"\\n\\nI have full access to 188 power units. How can I help you today?`);\r\n      }\r\n    });\r\n\r\n    setTimeout(() => {\r\n      python.kill();\r\n      resolve(`Processing your request: \"${userMessage}\". Please wait...`);\r\n    }, 10000);\r\n  });\r\n}\r\n\r\n// Export functions needed by routes\r\nexport async function getChatResponse(message: string, sessionId: string): Promise<string> {\r\n  return processWithAuroraIntelligence(message, sessionId);\r\n}\r\n\r\nexport async function searchWeb(query: string): Promise<any> {\r\n  return { results: [], message: `Searching for: ${query}` };\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 246, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/negry/Aurora-x/app/api/chat/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server'\r\nimport { getChatResponse } from '../../../server/aurora-chat'\r\n\r\nexport async function POST(request: NextRequest) {\r\n  const { message, session_id } = await request.json()\r\n  \r\n  if (!message) {\r\n    return NextResponse.json(\r\n      { error: 'Message is required' },\r\n      { status: 400 }\r\n    )\r\n  }\r\n  \r\n  const sessionId = session_id || 'default'\r\n  const response = await getChatResponse(message, sessionId)\r\n  \r\n  return NextResponse.json({\r\n    ok: true,\r\n    response,\r\n    message: response,\r\n    session_id: sessionId,\r\n    ai_powered: true\r\n  })\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,eAAe,KAAK,OAAoB;IAC7C,MAAM,EAAE,OAAO,EAAE,UAAU,EAAE,GAAG,MAAM,QAAQ,IAAI;IAElD,IAAI,CAAC,SAAS;QACZ,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAAsB,GAC/B;YAAE,QAAQ;QAAI;IAElB;IAEA,MAAM,YAAY,cAAc;IAChC,MAAM,WAAW,MAAM,IAAA,6IAAe,EAAC,SAAS;IAEhD,OAAO,gJAAY,CAAC,IAAI,CAAC;QACvB,IAAI;QACJ;QACA,SAAS;QACT,YAAY;QACZ,YAAY;IACd;AACF"}}]
}