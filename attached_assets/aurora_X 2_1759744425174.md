# AURORA-X — Project Notes & Live Tracker

> **Task Docs Sync (always-accurate docs)**
>
> - **Update tracker section in `aurora_X.md`:** `make summary`  
> - **Detect paste drift vs MASTER_TASK_LIST:** `make drift`  
> - Pre-commit runs both automatically (`tools/precommit.sh`) so docs never go stale.

Aurora-X Ultra is an offline, zero-API, secure-by-default program synthesis engine with a live HUD/Sidebar/Dashboard tracker.  
This document now contains the **canonical tracker block** and **sync tools** so your docs always match the true state.

---

## TL;DR — What Aurora Does Today
- Spec-DSL → tests (examples + fuzz + post-conditions)  
- AST synthesis (beam); scoring by examples + post; security audit  
- Iterate (mutate/resynthesize); sandboxed `unittest`; call-graph + scores; HTML report  
- Auto-debug scaffold (isolate fails, shrink hints, patch suggestions)  
- Tracker: HUD (floating), Sidebar (sticky), `/dashboard` UI, history snapshots & sparkline, CSV export  
- Offline-first; optional telemetry to Chango via env-gated POST (off by default)

---

## How To Keep This File In Sync
Run:
```bash
make summary   # upserts the canonical tracker block below
make drift     # prints diff if anything diverges from MASTER_TASK_LIST.md
```

---

## Current Scope & Non-Negotiables
- Offline-first (no external APIs by default)  
- Strict security auditing on generated code (AST; forbidden calls/imports)  
- Deterministic runs; isolated subsystems (easy to swap/fix)  
- If a recommendation improves quality/safety, implement it—don’t ask

---

<!-- AURORA_TRACKER_BEGIN -->
### ✅ Task Tracker Status (Authoritative, from progress.json)

**PHASE T01 — FOUNDATION CORE:** **100%**
- T01  Core Offline Engine .......... 100%  
- T01a Security Layer ............... 100%  
- T01b Auto Debug System ............ 100%  
- T01c CLI & Makefile ............... 100%  
- T01d Isolated Architecture ........ 100%  

**PHASE T02 — LEARNING & MEMORY CORE:** **93%**  <!-- (5×100 + 60)/6 = 93.33% -->
- T02a Schema & Storage ............. 100%  
- T02b Local Corpus Engine .......... 100%  
- T02c Telemetry & Sync ............. 100%  
- T02d Baseline Comparison .......... 100%  
- T02e Enhanced Reporting ........... 100%  
- T02f Persistent Learning Seeds .... 60%  

**PHASE T03 — ADAPTIVE LEARNING ENGINE:** **0%**
- T03a learn.py Engine .............. 0%  
- T03b Visualization Layer .......... 0%  
- T03c Dynamic Bias Scheduler ....... 0%  

**Notes**
- Engine is **spec-DSL-driven** (not natural-language prompts) with AST-synthesis, post-condition oracles, fuzzing, auto-debug scaffolding, HTML report, and tracker HUD/Sidebar/Dashboard.
- **Offline-first**. Optional export to Chango is gated by `AURORA_POST_URL` and `AURORA_API_KEY`. No `aurora_x/corpus/` module is shipped in the current capsule; further learning hooks are tracked under T02/T03.
<!-- AURORA_TRACKER_END -->

---

## Sync Tools (drop these into your repo)

> These are **documentation utilities**. They do **not** touch Aurora’s core engine.

### `tools/update_summary_md.py`
```python
#!/usr/bin/env python3
from __future__ import annotations
import subprocess, sys, shutil
from pathlib import Path

ROOT = Path(__file__).resolve().parents[1]
PROGRESS = ROOT / "progress.json"
UPDATE_PROGRESS = ROOT / "tools" / "update_progress.py"
MASTER = ROOT / "MASTER_TASK_LIST.md"
TARGET = ROOT / "aurora_X.md"  # change if your target file differs

BEGIN = "<!-- AURORA_TRACKER_BEGIN -->"
END   = "<!-- AURORA_TRACKER_END -->"
HEADER = "### ✅ Task Tracker Status (Authoritative, from progress.json)"

def ensure_master_uptodate():
    if not PROGRESS.exists():
        raise SystemExit("[update_summary_md] progress.json missing; cannot render tracker.")
    if not UPDATE_PROGRESS.exists():
        raise SystemExit("[update_summary_md] tools/update_progress.py missing.")
    subprocess.run([sys.executable, str(UPDATE_PROGRESS)], check=False)
    if not MASTER.exists():
        raise SystemExit("[update_summary_md] MASTER_TASK_LIST.md not generated.")

def read_text(p: Path) -> str:
    try: return p.read_text(encoding="utf-8")
    except FileNotFoundError: return ""

def write_text(p: Path, s: str) -> None:
    p.parent.mkdir(parents=True, exist_ok=True)
    p.write_text(s, encoding="utf-8")

def build_replacement_block() -> str:
    master = read_text(MASTER).strip()
    block = f"{HEADER}\n\n{master}\n"
    return f"{BEGIN}\n{block}\n{END}"

def upsert_block(doc: str, replacement: str) -> str:
    if BEGIN in doc and END in doc:
        pre = doc.split(BEGIN, 1)[0]
        post = doc.split(END, 1)[1]
        return pre + replacement + post
    section = "\n\n" + replacement + "\n"
    if not doc.strip():
        doc = "# Aurora-X — Project Notes\n\n"
    if HEADER in doc and BEGIN not in doc:
        return doc + section
    return doc + section

def main():
    ensure_master_uptodate()
    current = read_text(TARGET)
    new_block = build_replacement_block()
    updated = upsert_block(current, new_block)
    if updated != current:
        bak = TARGET.with_suffix(TARGET.suffix + ".bak")
        try: shutil.copyfile(TARGET, bak)
        except Exception: pass
        write_text(TARGET, updated)
        print(f"[ok] updated {TARGET.name} with canonical tracker block.")
    else:
        print("[ok] no changes; tracker block already up-to-date.")

if __name__ == "__main__":
    main()
```

### `tools/check_task_drift.py`
```python
#!/usr/bin/env python3
from __future__ import annotations
import sys, difflib
from pathlib import Path

ROOT = Path(__file__).resolve().parents[1]
MASTER = ROOT / "MASTER_TASK_LIST.md"
TARGET = ROOT / "aurora_X.md"  # change if your target file differs

BEGIN = "<!-- AURORA_TRACKER_BEGIN -->"
END   = "<!-- AURORA_TRACKER_END -->"

def read_text(p: Path) -> str:
    try: return p.read_text(encoding="utf-8")
    except FileNotFoundError: return ""

def extract_block(text: str) -> str:
    if BEGIN in text and END in text:
        return text.split(BEGIN,1)[1].split(END,1)[0]
    return ""

def normalize(s: str) -> list[str]:
    lines = [ln.rstrip() for ln in s.strip().splitlines() if ln.strip()]
    return lines

def main():
    if not MASTER.exists():
        print("[drift] MASTER_TASK_LIST.md missing; run tools/update_progress.py first.")
        sys.exit(1)
    target = read_text(TARGET)
    if not target:
        print(f"[drift] {TARGET.name} missing; cannot compare.")
        sys.exit(1)

    block = extract_block(target)
    if not block:
        print(f"[drift] No tracker block markers in {TARGET.name}. Expected markers:\n{BEGIN}\n...\n{END}")
        sys.exit(1)

    master_norm = normalize(read_text(MASTER))
    block_norm = normalize(block)

    if master_norm != block_norm:
        print("[drift] aurora_X.md tracker section differs from MASTER_TASK_LIST.md")
        diff = difflib.unified_diff(block_norm, master_norm,
                                    fromfile="aurora_X.md::tracker",
                                    tofile="MASTER_TASK_LIST.md",
                                    lineterm="")
        for line in diff:
            print(line)
        sys.exit(2)

    print("[ok] No drift detected.")
    sys.exit(0)

if __name__ == "__main__":
    main()
```

### `tools/precommit.sh`
```bash
#!/usr/bin/env bash
set -e
python tools/update_progress.py
python tools/update_summary_md.py
python tools/check_progress_regression.py
python tools/check_task_drift.py
```

### Makefile additions
```make
# Task docs sync & drift checks
summary:
	@python tools/update_summary_md.py

drift:
	@python tools/check_task_drift.py || true
```

---

## Usage Recap
```bash
pip install -e .
make run && make open-report

# Serve dashboard
make serve PORT=8000   # http://localhost:8000  (dashboard at /dashboard)

# Docs sync
make summary
make drift
```
